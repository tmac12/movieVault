version: '3.8'

services:
  movievault:
    build: .
    container_name: movievault
    ports:
      - "${WEB_PORT:-8080}:80"
    volumes:
      # Mount your movie directories (read-only)
      # Customize these paths to match your movie locations
      - /path/to/your/movies:/movies:ro

      # Persistent data (generated MDX and covers)
      - ./data/movies:/data/movies
      - ./data/covers:/data/covers

      # Configuration (uses Docker-specific config with env vars)
      - ./config/config.docker.yaml:/config/config.yaml:ro
    environment:
      - TMDB_API_KEY=${TMDB_API_KEY}
      - AUTO_SCAN=${AUTO_SCAN:-true}
      - SCAN_INTERVAL=${SCAN_INTERVAL:-3600}
    restart: unless-stopped

  # Optional: Separate scanner service (runs periodically)
  # Uncomment if you want a dedicated scanner container
  # scanner:
  #   build: .
  #   container_name: movievault-scanner
  #   volumes:
  #     - /path/to/your/movies:/movies:ro
  #     - ./data/movies:/data/movies
  #     - ./data/covers:/data/covers
  #     - ./config/config.yaml:/config/config.yaml:ro
  #   environment:
  #     - TMDB_API_KEY=${TMDB_API_KEY}
  #   command: sh -c "while true; do scanner && sleep ${SCAN_INTERVAL:-3600}; done"
  #   restart: unless-stopped
